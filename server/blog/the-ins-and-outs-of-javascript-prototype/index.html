<!DOCTYPE html>
<html>
<head>
  <title>Ins and Outs of Javascript Prototype | WegnerDesign</title>
  <link rel="stylesheet" type="text/css" href="/stylesheets/blog.css" />
  <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" />
  <link rel="stylesheet" type="text/css" href="/fonts/stylesheet.css" />
  <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-19623283-1']);
      _gaq.push(['_setDomainName', 'wegnerdesign.com']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
  </script>
  <script type="text/javascript">
    function go() {
      var tweetLink = document.getElementsByClassName("tweet")[0].getElementsByTagName("a")[0];

      var url = encodeURIComponent("http://www.wegnerdesign.com/blog/the-ins-and-outs-of-javascript-prototype");
      var name = encodeURIComponent("Ins and Outs of Javascript Prototype via #WegnerDesign")

      tweetLink.href = "https://twitter.com/intent/tweet?url="+url+"&text="+name;
    }
  </script>
  <meta property="og:type" content="article" />
  <meta property="og:title" content="" />
  <meta property="og:url" content="" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="WegnerDesign" />
</head>
<body onload="go();">
  <div id="socialColumn">
    <div class='tweet'><a target="_blank" href="#"></a></div>
  </div>
  <div id="metaColumn">
    <div id="logo">
      <img src="/images/logo.png" />
    </div>
    <div id="footercontrols">
      <div id="index"><a href="/blog"><img src="/images/index.png" /></a></div><!--
     --><div id="rss"><a href="/feed.xml"><img src="/images/rss.png" /></a></div></div>
    </div>
  </div>
  <div id="post">
    <h2><span class='title'>Ins and Outs of Javascript Prototype</span><span class="date">27 April 2013</span></h2>
    <div id="body"><p>Earlier this year I was in search of a new job, and was specifically looking for a frontend development position with a focus on javascript.  I&#39;m pretty passionate about the javascript language, so every interview that popped up for a JS-heavy position I jumped on.  That ended up being like twenty interviews within a few weeks (Well done, Chicago).  Around interview #10 I started to take a note of some trends in the technical portion of the interviews.  More often than not I was being interview by a non-technical person who had either Google&#39;d or been given a list of important javasript questions.  The three things that always came up were closures, hoisting, and prototype.</p>

<p>Truthfully, I&#39;m a little bit disappointed in that list.  Closures and hoisting are both important topics to understand, but those are the kinds of things that if you don&#39;t know, you&#39;ll quickly figure out as soon as one causes a bug.  Essential javascript knowledge, but not really a sign of a javascript &quot;guru&quot;.</p>

<p>Prototype, though, is a very interesting concept.  I&#39;m very glad I was asked about it, and actually wish that my interviewers had had a better understanding of just how prototype works.  I hope the same things for you, because prototype is an essential piece of javascript - hopefully this blog post will help.</p>

<h2>Prototype - Inheritance for Javascript</h2>

<p>On a very basic level, prototype gives javascript the ability to create class-like inheritance using objects.  We know that (mostly) <a href="http://mirkokiefer.com/blog/2010/02/everything-is-an-object-in-javascript/">everything is an object</a> in javascript.  However, there&#39;s something unqiue about a function-object.  The first unique thing is that every function-object is instantiated with a <code>prototype</code> parameter, which is also an object.  The second unique thing is that you can use the <code>new</code> keyword on a function-object to create a &quot;child&quot; of that object.  </p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">Dog</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;bark!&quot;</span><span class="p">);</span>
<span class="p">};</span> <span class="c1">// The function-object</span>

<span class="kd">var</span> <span class="nx">cody</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">();</span> <span class="c1">//The child object.  This will alert &quot;bark!&quot;</span>
</code></pre></div>

<p>Prototype gives us some special abilities when creating child objects out of function-objects.  When you add keys to the prototype parameter they automatically get added on to the child object.  That means that you can define class-level functions like <code>bark();</code> that will get applied to every new child object.</p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">Dog</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>   
<span class="p">};</span>

<span class="nx">Dog</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bark</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;bark!&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">Dog</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">speakName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;bark! &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;! bark!&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">cody</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="s2">&quot;Cody&quot;</span><span class="p">);</span>
<span class="nx">cody</span><span class="p">.</span><span class="nx">bark</span><span class="p">();</span> <span class="c1">//alerts &quot;bark!&quot;</span>
<span class="nx">cody</span><span class="p">.</span><span class="nx">speakName</span><span class="p">();</span> <span class="c1">//alerts &quot;bark! Cody! bark!&quot;</span>
</code></pre></div>

<p>Just as a note, the keys on prototype can be of any type.  It&#39;s commonly used for functions, but you can set it as a string, number, function, or even another object.</p>

<h2>Prototype By Reference</h2>

<p>You&#39;re probably wondering why in the world you would want to use prototype, rather than just adding the keys in the constructor.  Prototype creates some spaghetti code - it would be much easier just to do this:</p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">Dog</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bark</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;bark!&quot;</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">}</span>    

<span class="kd">var</span> <span class="nx">cody</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="s2">&quot;Cody&quot;</span><span class="p">);</span>
<span class="nx">cody</span><span class="p">.</span><span class="nx">bark</span><span class="p">();</span> <span class="c1">//alerts &quot;bark!&quot;</span>
<span class="p">};</span>
</code></pre></div>

<p>You&#39;re right.  That would work just as well as the example above, but it&#39;s pretty short sighted.  The way the above works is that everytime you create a new Dog, it runs the constructor function and instantiates new functions on the desired keys.  Not only is this inefficient processing-wise and memory-wise, it also severely limits your inheritance and abstraction abilities.</p>

<p>Consider a different example - let&#39;s say you are writing a game about working at a zoo - naturally you&#39;re going to have some <code>Animal</code> objects.  One of the most interesting things about going to the zoo is the noises each animal makes, so we defintely want to have a <code>speak</code> function on <code>Animal</code>.  Now, what noise does an animal make?  Certainly it should change depending on if it&#39;s a monkey or a polar bear.</p>

<p>In order to do the abstraction on the <code>Animal</code> class, we have to store the <code>speak</code> function on <code>Animal</code>&#39;s prototype, and then override it on each child class.  Note that a generic <code>Animal</code> won&#39;t make any noise, so that&#39;s what the <code>Animal.speak</code> function will do.</p>

<div class="highlight"><pre><code class="javascript"><span class="c1">//First define our generic Animal class.  By having this root level class,</span>
<span class="c1">//our subclasses don&#39;t have to recreate every function if there is no reason to,</span>
<span class="c1">//but our application can always expect an Animal to have a &quot;speak&quot; function.</span>
<span class="kd">var</span> <span class="nx">Animal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Animal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">speak</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="c1">//Most animals don&#39;t actually make any noise.</span>
<span class="p">};</span>

<span class="c1">//I like monkeys.  Conveniently, they also make an interesting noise</span>
<span class="kd">var</span> <span class="nx">Monkey</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">//This creates a copy of Animal&#39;s prototype and puts it on Monkey&#39;s.</span>
<span class="c1">//If you simply did an assignment of one prototype to the other, </span>
<span class="c1">//it would be copied by reference.  Then any changes to Monkey.speak</span>
<span class="c1">//would affect Animal.speak</span>
<span class="nx">Monkey</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Animal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>

<span class="nx">Monkey</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">speak</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hoo Hoo, Hah Hah!&quot;</span><span class="p">);</span> <span class="c1">//How cute</span>
<span class="p">}</span>

<span class="c1">//I also like sloths.  They don&#39;t make a noise, but we still want them to have their own class.</span>
<span class="kd">var</span> <span class="nx">Sloth</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
<span class="p">}</span>


<span class="nx">Sloth</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Animal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>

<span class="c1">//Now we can play with the Monkeys and Sloths!</span>
<span class="kd">var</span> <span class="nx">curiousGeorge</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Monkey</span><span class="p">(</span><span class="s2">&quot;George&quot;</span><span class="p">,</span> <span class="s2">&quot;brown&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">steveTheSloth</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sloth</span><span class="p">(</span><span class="s2">&quot;Steve&quot;</span><span class="p">);</span>

<span class="nx">curiousGeorge</span><span class="p">.</span><span class="nx">speak</span><span class="p">();</span> <span class="c1">//alerts Hoo Hoo, Hah Hah!</span>
<span class="nx">steveTheSloth</span><span class="p">.</span><span class="nx">speak</span><span class="p">();</span> <span class="c1">//alerts nothing</span>
</code></pre></div>

<p>If we had instead set all of the functions in the <code>Animal</code> constructor, we would have had to rewrite the <code>speak</code> function for the <code>Sloth</code>, even though sloths don&#39;t make any noise.  This may seem like a negligible amount of work, but I hope you aspire to do more interesting work than programming <code>Sloth</code>s all day.</p>

<h2>Advanced - Object Interfaces</h2>

<p>The patterns above defintely get us within the bounds of saying that javascript is object oriented.  However, it&#39;s not yet quite as powerful as other more traditional OOP languages.  One of the things I really like about OOP programming is being able to manage abstractions via <a href="http://www.cs.utah.edu/%7Egermain/PPS/Topics/interfaces.html">Object Interfaces</a>.  Object Interfaces let you define an abstract class that requires child classes to have certain functions.  In the above example, we might require that every Animal be able to move.  However, every animal moves/walks in a different way, so there isn&#39;t a generic way to do that on the parent class.</p>

<p>I&#39;ve been using a pattern recently to mock standard Object Interfacing.  Of course, the code isn&#39;t quite as clean as a language that supports interfacing out of the box, but it gets the job done.</p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">Animal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>

<span class="c1">//The child class will call super immediately upon construction</span>
<span class="nx">Animal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kr">super</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>

    <span class="c1">//Verify that necessary functions exists</span>
    <span class="kd">var</span> <span class="nx">necessaryFunctions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;move&quot;</span><span class="p">]</span>

    <span class="c1">//Loops through the necessary functions to see if they exist</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">max</span><span class="o">=</span><span class="nx">necessaryFunctions</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">max</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">necessaryFunctions</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span> <span class="o">!==</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Animals must have a function called &quot;</span> <span class="o">+</span> <span class="nx">necessaryFunctions</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">//Checks to see if the child class has an init function.  If it does, it calls it</span>
    <span class="c1">//with all the same arguments that hit this super.</span>
    <span class="k">if</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Animal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">speak</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="c1">//Most animals don&#39;t actually make any noise.</span>
<span class="p">};</span>

<span class="c1">//On construction, the child class calls the parent class&#39;s super function.</span>
<span class="c1">//The super function will check the object interface requirements</span>
<span class="c1">//and then call the child class&#39;s init function</span>
<span class="kd">var</span> <span class="nx">Monkey</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="kr">super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">Monkey</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Animal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>

<span class="c1">//name was already set in the super constructor!</span>
<span class="nx">Monkey</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Monkey</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">speak</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hoo Hoo, Hah Hah!&quot;</span><span class="p">);</span> <span class="c1">//How cute</span>
<span class="p">}</span>

<span class="nx">Monkey</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//Do some moving!</span>
<span class="p">}</span>

<span class="c1">//Now lets create a sloth without a move function and see what happens</span>
<span class="kd">var</span> <span class="nx">Sloth</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="kr">super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">Sloth</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Animal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>

<span class="c1">//We are leaving out the Sloth&#39;s init function, because the name is already set in the constructor</span>

<span class="c1">//Now the Monkey should pass, but the Sloth should not because it does not have a move function.</span>
<span class="kd">var</span> <span class="nx">curiousGeorge</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Monkey</span><span class="p">(</span><span class="s2">&quot;George&quot;</span><span class="p">,</span> <span class="s2">&quot;brown&quot;</span><span class="p">);</span>
<span class="nx">curiousGeorge</span><span class="p">.</span><span class="nx">speak</span><span class="p">();</span> <span class="c1">//alerts Hoo Hoo, Hah Hah!</span>

<span class="kd">var</span> <span class="nx">steveTheSloth</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sloth</span><span class="p">(</span><span class="s2">&quot;Steve&quot;</span><span class="p">);</span> <span class="c1">//Throws error</span>
</code></pre></div>
</div>
    <div id="disqus_thread" style="width: 75%; margin-top: 50px;"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'wegnerdesign'; // required: replace example with your forum shortname
        var disqus_identifier = '';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
  <div id="footer"></div>
</body>
</html>